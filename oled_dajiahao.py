"""
oled_dajiahao.py

示範：使用陣列 (pixel map) 在 SSD1306 OLED 上畫出「大家好」三個字的大致像素圖。

說明：
 - 每個字使用 16x16 的像素陣列 (每列為 '0'/'1' 字串)，'1' 表示點亮。
 - 使用 `oled.pixel(x,y,1)` 把像素畫到 OLED，最後呼叫 `oled.show()` 顯示。
 - 這是簡單的手工像素圖，用來示範如何用陣列上傳自訂中文圖案到 OLED（SSD1306 預設只支援英數字體）。

使用方式：
 - 上傳到開發板後，在 REPL 執行：
     import oled_dajiahao
     oled_dajiahao.main()

注意：若要改變字型大小或位置，可修改陣列尺寸或繪製起始 x,y。
"""

from machine import I2C
from lib.ssd1306 import SSD1306_I2C
import utime


# 每個字為 16x16，'1' 表示點亮，'0' 表示不點亮
# 以下為手繪的簡易像素版，僅供示意（可依需求修改）
CHAR_DA = [
    '0000100000000000',
    '0000100000000000',
    '0000100000000000',
    '0000100000000000',
    '0000100000000000',
    '0000100000000000',
    '0001111110000000',
    '0000100100000000',
    '0000100100000000',
    '0000100100000000',
    '0000100100000000',
    '0000100100000000',
    '0000100100000000',
    '0000100100000000',
    '0000100100000000',
    '0000000000000000',
]

CHAR_JIA = [
    '0000010000000000',
    '0000111000000000',
    '0001111110000000',
    '0010000010000000',
    '0100000001000000',
    '1000000000100000',
    '1111111111110000',
    '0001000010000000',
    '0001000010000000',
    '0001000010000000',
    '0001000010000000',
    '0001000010000000',
    '0001000010000000',
    '0001000010000000',
    '0001000010000000',
    '0000000000000000',
]

CHAR_HAO = [
    '0001000001000000',
    '0001000001000000',
    '0001000001000000',
    '0001000001000000',
    '0001111111110000',
    '0001000001000000',
    '0001000001000000',
    '0001000001000000',
    '0001000001000000',
    '0001000001000000',
    '0001111111110000',
    '0000001000000000',
    '0000010100000000',
    '0000100010000000',
    '0001000001000000',
    '0000000000000000',
]


def draw_bitmap(oled, x0, y0, bitmap):
    """把 bitmap (list of '0'/'1' strings) 繪到 oled，左上角為 (x0,y0)。"""
    h = len(bitmap)
    if h == 0:
        return
    w = len(bitmap[0])
    # 逐像素繪製
    row = 0
    while row < h:
        col = 0
        line = bitmap[row]
        while col < w:
            try:
                if line[col] == '1':
                    oled.pixel(x0 + col, y0 + row, 1)
            except IndexError:
                # 如果某列長度不齊，忽略
                pass
            col += 1
        row += 1


def main():
    """初始化 I2C 與 OLED，並在螢幕上顯示『大家好』。"""
    try:
        i2c0 = I2C(0, I2C.MASTER, baudrate=100000)
        oled = SSD1306_I2C(128, 64, i2c0)
    except Exception:
        print('無法初始化 I2C 或 OLED，請確認硬體或驅動')
        return

    oled.fill(0)

    # 三個字寬度為 16，各字之間保留 4 pixel 間隔
    x_start = 8
    y_start = 16

    draw_bitmap(oled, x_start + 0 * (16 + 4), y_start, CHAR_DA)
    draw_bitmap(oled, x_start + 1 * (16 + 4), y_start, CHAR_JIA)
    draw_bitmap(oled, x_start + 2 * (16 + 4), y_start, CHAR_HAO)

    oled.show()


if __name__ == '__main__':
    main()
